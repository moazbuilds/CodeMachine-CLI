---
title: "Components"
description: "Learn the building blocks that make up every CodeMachine workflow."
sidebarTitle: "Components"
---

**Every workflow is made of these pieces.**

Understanding them will help you build, customize, and share workflows.

## Workflows

A workflow is a configured execution plan. It defines which agents run, in what order, with what controls, and how context flows between them.

A workflow contains:

- **Steps** - The execution sequence
- **Agents** - Who does the work
- **Tracks & Conditions** - Branching based on user choices
- **Controls** - Autonomy, interactivity, engines, models

## Agents

An agent is a session of an AI coding engine. One agent equals one engine session with a unique ID. Each agent has its own engine, model, and configuration.

| Type           | Role                                                                      |
| -------------- | ------------------------------------------------------------------------- |
| **Main Agent** | Runs as a step in the workflow                                            |
| **Module**     | A main agent that can loop back to earlier steps                          |
| **Sub-agent**  | Spawned by main agents via MCP to delegate work and return results        |
| **Controller** | Orchestrates on your behalf - answers agent questions, signals next steps |

Sub-agents are not steps. They are a context management tool for delegating work between agents.

## Steps

A step is an execution of an agent. Input and output are defined in prompts using placeholders. Steps run sequentially.

A module is a step that can loop back to repeat earlier steps or retry if validation fails.

**What triggers the next step:**

- **Interactive mode** - User confirms to proceed
- **Autonomous mode** - Controller agent signals to proceed

**What passes between steps:**

- Files and outputs
- User choices (tracks, conditions)
- Built-in data (date, time, project info)

## Engines & Models

An engine is an AI coding CLI such as Claude Code, Codex, Cursor, or others.

A model is the AI model used by that engine.

Both are configured per agent. You can mix different engines and models in one workflow. For example, use Codex for planning and Claude Code for implementation.

## Placeholders

Placeholders inject data into agent prompts.

**File Injection:**

| Type                | Source                                    | Use case                                                    |
| ------------------- | ----------------------------------------- | ----------------------------------------------------------- |
| Static (packageDir) | Pre-defined prompts from workflow package | Shared prompts, split large prompts, separation of concerns |
| Dynamic (userDir)   | Files created during workflow             | Agent A outputs a file, Agent B receives it as input        |

Dynamic placeholders expect files that do not exist yet. Previous agents produce them for later agents.

**Built-in Placeholders:**

System data injected automatically:

- Date and time
- Username and project name
- Selected tracks and conditions
- Other workflow context

## Tracks & Conditions

Tracks and conditions are onboarding questions asked at the start of a workflow. User answers:

- Enable or disable specific steps and agents
- Generate placeholders injected into prompts
- Tell agents how to behave based on user choices

This creates multiple workflow paths inside a single workflow definition.

## Directives

Directives allow agents to control the workflow by writing to a JSON file. The workflow listens after each step and takes action.

| Directive    | Action                                            |
| ------------ | ------------------------------------------------- |
| `checkpoint` | Shows message to user, option to continue or stop |
| `stop`       | Stops the workflow                                |
| `error`      | Shows error message and stops                     |
| `pause`      | Pauses and waits for user input                   |
| `loop`       | Returns back to a previous step (modules only)    |
| `trigger`    | Triggers any agent in the workflow (modules only) |

## Chained Prompts

Chained prompts are multiple prompts injected into the same agent session, one after another. Instead of overwhelming one step with all instructions, you break it into smaller sequential prompts.

- Same agent, same session
- Prompts run in sequence
- Common in interactive Q&A workflows
- Defined per agent

## Imports

Imports are external workflows built by the CodeMachine team or community.

- Shared via external repos
- Contains workflows, agents, prompts, and config
- Install via TUI or CLI
- Anyone can share, anyone can install

**Built-in workflows** come with the CodeMachine package. **Imports** are installed separately.

```bash
/import
# to install external workflows
```

## Next Steps

- [Workflow Patterns →](./workflow/patterns) - See the different shapes workflows can take
- [Workflow Controls →](./workflow/controls) - Understand how to control execution
