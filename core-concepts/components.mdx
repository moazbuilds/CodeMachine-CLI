---
title: "Components"
description: "Learn the building blocks that make up every CodeMachine workflow."
sidebarTitle: "Components"
---

**Every workflow is made of these pieces.**

Understanding them will help you build, customize, and share workflows.

## At a Glance

<CardGroup cols={4}>
  <Card title="Workflows" icon="sitemap" href="#workflows">
    Execution plans
  </Card>
  <Card title="Agents" icon="robot" href="#agents">
    Who does the work
  </Card>
  <Card title="Steps" icon="list-ol" href="#steps">
    Execution sequence
  </Card>
  <Card title="Engines" icon="server" href="#engines--models">
    AI coding CLIs
  </Card>
</CardGroup>

<CardGroup cols={4}>
  <Card title="Placeholders" icon="code" href="#placeholders">
    Data injection
  </Card>
  <Card title="Tracks" icon="code-branch" href="#tracks--conditions">
    Workflow branching
  </Card>
  <Card title="Directives" icon="terminal" href="#directives">
    Agent controls
  </Card>
  <Card title="Imports" icon="download" href="#imports">
    External workflows
  </Card>
</CardGroup>

---

## Workflows

A workflow is a configured execution plan. It defines which agents run, in what order, with what controls, and how context flows between them.

- <Icon icon="list-ol" /> **Steps** - Main agents or modules that run in sequence

  May include:
  - <Icon icon="share-nodes" /> **Sub-agents** - Spawned to delegate work
  - <Icon icon="plug" /> **MCP** - Tool servers that extend agent capabilities
  - <Icon icon="code-branch" /> **Tracks & Conditions** - Branching based on user choices
  - <Icon icon="sliders" /> **Controls** - Autonomy, interactivity, engines, models

---

## Steps

Steps define execution order. Agents define who does the work. Every step requires an agent. Steps run sequentially.

**Triggers:**
- <Icon icon="hand" /> **Interactive mode** - User confirms to proceed
- <Icon icon="robot" /> **Autonomous mode** - Controller agent signals to proceed

**What passes between steps:**
- <Icon icon="file" /> Files and outputs
- <Icon icon="code-branch" /> User choices (tracks, conditions)
- <Icon icon="gear" /> Built-in data (date, time, project info)

---

## Agents

An agent is a session of an AI coding engine. One agent equals one engine session with a unique ID. Each agent has its own engine, model, and configuration.

- <Icon icon="robot" /> **Main Agent** - Runs as a step in the workflow
- <Icon icon="rotate" /> **Module** - A main agent that can loop back to earlier steps
- <Icon icon="share-nodes" /> **Sub-agent** - Spawned by main agents via MCP to delegate work and return results
- <Icon icon="gamepad" /> **Controller** - Orchestrates on your behalf - answers agent questions, signals next steps

<Note>
  Sub-agents are not steps. They are a context management tool for delegating work between agents.
</Note>

---

## Engines & Models

- <Icon icon="server" /> **Engine** - An AI coding CLI (Claude Code, Codex, Cursor, others)
- <Icon icon="microchip" /> **Model** - The AI model used by that engine

Both are configured per step/agent. You can mix different engines and models in one workflow.

<Tip>
  For example, use Codex for planning and Claude Code for implementation.
</Tip>

---

## Placeholders

Placeholders inject data into agent prompts.

<Icon icon="file" /> **File Injection:**

| Type                | Source                                    | Use case                                                    |
| ------------------- | ----------------------------------------- | ----------------------------------------------------------- |
| Static (packageDir) | Pre-defined prompts from workflow package | Shared prompts, split large prompts, separation of concerns |
| Dynamic (userDir)   | Files created during workflow             | Agent A outputs a file, Agent B receives it as input        |

Dynamic placeholders expect files that do not exist yet. Previous agents produce them for later agents.

<Icon icon="gear" /> **Built-in:**

System data injected automatically:

- Date and time
- Username and project name
- Selected tracks and conditions
- Other workflow context

---

## Tracks & Conditions

Tracks and conditions are onboarding questions asked at the start of a workflow. User answers:

- Enable or disable specific steps and agents
- Generate placeholders injected into prompts
- Tell agents how to behave based on user choices

<Info>
  This creates multiple workflow paths inside a single workflow definition.
</Info>

---

## Directives

Directives allow agents to control the workflow by writing to a JSON file. The workflow listens after each step and takes action.

| Directive    | Action                                            |
| ------------ | ------------------------------------------------- |
| `checkpoint` | Shows message to user, option to continue or stop |
| `stop`       | Stops the workflow                                |
| `error`      | Shows error message and stops                     |
| `pause`      | Pauses and waits for user input                   |
| `loop`       | Returns back to a previous step (modules only)    |
| `trigger`    | Triggers any agent in the workflow (modules only) |

---

## Chained Prompts

Chained prompts are multiple prompts injected into the same agent session, one after another. Instead of overwhelming one step with all instructions, you break it into smaller sequential prompts.

<Info>
  Same agent, same session. Prompts run in sequence. Common in interactive Q&A workflows. Defined per agent.
</Info>

---

## Imports

Imports are external workflows built by the CodeMachine team or community.

- Shared via external repos
- Contains workflows, agents, prompts, and config
- Install via TUI or CLI
- Anyone can share, anyone can install

```bash
/import
# to install external workflows
```

<Tip>
  **Built-in workflows** come with the CodeMachine package. **Imports** are installed separately.
</Tip>

---

## Next Steps

<CardGroup cols={2}>
  <Card title="Workflow Patterns" icon="shuffle" href="./workflow/patterns">
    See the different shapes workflows can take
  </Card>
  <Card title="Workflow Controls" icon="sliders" href="./workflow/controls">
    Understand how to control execution
  </Card>
</CardGroup>
